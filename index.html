<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fraudulent Allegations Companies Database</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #eee;
    }
    .container {
      background: white;
      padding: 20px;
      max-width: 700px;
      margin: 0 auto;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #d32f2f;
      text-align: center;
      margin-bottom: 5px;
    }
    h2.subheading {
      color: #555;
      font-weight: normal;
      text-align: center;
      font-size: 1.1rem;
      margin-bottom: 20px;
    }
    .info-section {
      background: #fff3cd;
      border-left: 6px solid #ffc107;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 5px;
    }
    #searchBox {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 15px;
    }
    #results {
      list-style: none;
      padding: 0;
      margin: 0;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fafafa;
      max-height: 200px;
      overflow-y: auto;
    }
    #results li {
      padding: 10px;
      border-bottom: 1px solid #ddd;
      cursor: pointer;
    }
    #results li:hover {
      background-color: #f0f0f0;
    }
    .hidden {
      display: none;
    }
    #pdfViewerContainer {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: white;
      z-index: 1000;
      overflow-y: auto;
      padding: 20px 20px 80px 20px;
    }
    #pdfViewerContainer button {
      margin: 10px 5px;
      padding: 10px 20px;
      background: #d32f2f;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .green-button {
      background-color: green !important;
    }
    #uploadForm {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: #f9f9f9;
    }
    #uploadForm textarea {
      width: 100%;
      height: 60px;
      padding: 10px;
    }
    #uploadForm input[type="file"],
    #uploadForm input[type="text"],
    #uploadForm input[type="email"] {
      margin: 10px 0;
      width: 100%;
      padding: 8px;
    }
    #uploadForm button {
      background: green;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 10px;
    }
    #confirmationMessage {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      background-color: #e8f5e9;
      color: #2e7d32;
      font-weight: bold;
      text-align: center;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Nigeria Scam Allegations Companies Database</h1>
    <h2 class="subheading">A public petition archive to warn others and encourage accountability</h2>
<input type="text" id="searchBox" placeholder="Search company..Sujimoto..Pwan" />
    <ul id="results"></ul>
    <div class="info-section" aria-label="Mission statement">
      <p>Our mission is to provide a transparent, community-driven platform that establishes and displays live petitions against rogue companies alleged to have defrauded individuals. By sharing verified evidence and petitions here, we help warn the public and promote accountability.</p>
    </div>

    <div class="info-section" aria-label="Important scam information">
      <p><strong>Have you been scammed by a Real Estate Company in Lagos?</strong><br />
      Send your evidence of payment to <a href="https://wa.me/2347077513836" target="_blank" rel="noopener noreferrer">ADMIN</a>. A <strong>PETITION</strong> to EFCC will be automatically created for you, and the company name and petition will be made live on this website to <strong>WARN</strong> others.</p>

      <p><strong>Does your Company appear on this list?</strong><br />
      To get your company name removed from this database, contact <a href="https://wa.me/2347077513836" target="_blank" rel="noopener noreferrer">ADMIN</a>, providing evidence that you have <strong>SUFFICIENTLY</strong> clarified and paid out the fraudulent allegations against your company. Once the petitioner <strong>CONFIRMS</strong> receipt, your company will be removed from the database within 24 hours.</p>
    </div>

   

    <div id="pdfViewerContainer" class="hidden">
      <button onclick="closeViewer()">Close</button>
      <button class="green-button" onclick="toggleUploadForm()">Submit a New Petition</button>

      <!-- Petition Upload Form -->
      <form id="uploadForm" class="hidden" enctype="multipart/form-data">
        <input type="text" name="name" placeholder="Your Full Name" required />
        <input type="email" name="email" placeholder="Your Email Address" required />
        <textarea name="details" placeholder="Brief details of how you were scammed..." required></textarea>
        <input type="file" name="attachments" multiple accept=".pdf,image/*" />
        <input type="hidden" name="company" id="selectedCompany" />
        <button type="submit">Send New Petition</button>
      </form>

      <div id="confirmationMessage">
        Thank you for sending your new Petition against the company you have an issue with. <br />
        The petition will be made live on the website within 24 hours to warn others.
      </div>

      <div id="pdfContent"></div>
    </div>
  </div>

  <script>
    const searchBox = document.getElementById("searchBox");
    const resultsList = document.getElementById("results");
    const pdfViewerContainer = document.getElementById("pdfViewerContainer");
    const pdfContent = document.getElementById("pdfContent");
    const uploadForm = document.getElementById("uploadForm");
    const selectedCompanyInput = document.getElementById("selectedCompany");

    let companies = [];

    fetch('data/companies.json')
      .then(res => res.json())
      .then(data => companies = data);

    searchBox.addEventListener('input', () => {
      const query = searchBox.value.toLowerCase();
      resultsList.innerHTML = '';
      if (!query) return;

      companies
        .filter(c => c.name.toLowerCase().includes(query))
        .forEach(company => {
          const li = document.createElement('li');
          li.textContent = company.name;
          li.onclick = () => showPetitions(company);
          resultsList.appendChild(li);
        });
    });

    function showPetitions(company) {
      selectedCompanyInput.value = company.name;
      pdfViewerContainer.classList.remove("hidden");
      pdfContent.innerHTML = `<h2>${company.heading}</h2>`;

      company.petitions.forEach(petition => {
        const label = document.createElement('p');
        label.innerHTML = `<strong>${petition.title}</strong>`;

        const viewBtn = document.createElement('button');
        viewBtn.textContent = "View PDF";
        viewBtn.onclick = () => window.open(petition.file, '_blank');

        const downloadBtn = document.createElement('button');
        downloadBtn.textContent = "Download PDF";
        downloadBtn.onclick = () => {
          const a = document.createElement('a');
          a.href = petition.file;
          a.download = '';
          a.click();
        };

        pdfContent.appendChild(label);
        pdfContent.appendChild(viewBtn);
        pdfContent.appendChild(downloadBtn);
      });
    }

    function closeViewer() {
      pdfViewerContainer.classList.add("hidden");
      pdfContent.innerHTML = '';
      uploadForm.classList.add("hidden");
    }

    function toggleUploadForm() {
      uploadForm.classList.toggle("hidden");
    }

    uploadForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(uploadForm);

      const response = await fetch('https://petitionwebsite.onrender.com/submit', {
        method: 'POST',
        body: formData,
      });

      if (response.ok) {
        uploadForm.reset();
        uploadForm.classList.add("hidden");

        const confirmationMessage = document.getElementById("confirmationMessage");
        confirmationMessage.style.display = "block";

        setTimeout(() => {
          confirmationMessage.style.display = "none";
        }, 5000);
      } else {
        alert('Failed to submit petition.');
      }
    });
  </script>
</body>
</html>
